#include <stdio.h>

#define SIZE 20

int Find_way(char maze[SIZE][SIZE],int x,int y);
void Print_maze(char maze[SIZE][SIZE]);
char Access(char maze[SIZE][SIZE],int x,int y);

int main(void)
{
  char maze[SIZE][SIZE]={
    {'#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#'},
    {'.',' ','#',' ',' ',' ',' ',' ',' ','#','#','#','#','#','#','#','#','#','#','#'},
    {'#',' ','#',' ','#',' ','#','#',' ','#','#','#','#','#','#','#','#','#','#','#'},
    {'#',' ','#',' ','#','#','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#'},
    {'#',' ','#',' ',' ',' ',' ',' ',' ','#','#','#','#','#','#','#','#',' ',' ',' '},
    {'#',' ','#',' ','#','#','#','#',' ','#','#','#','#','#','#','#','#',' ','#','#'},
    {'#',' ','#',' ',' ',' ',' ','#',' ','#','#','#',' ','#','#','#','#',' ','#','#'},
    {'#',' ','#','#','#','#',' ','#',' ','#','#','#',' ',' ',' ',' ',' ',' ','#','#'},
    {'#',' ',' ',' ',' ',' ',' ','#',' ',' ',' ','#','#','#',' ','#','#',' ','#','#'},
    {'#','#',' ','#','#','#',' ','#','#','#',' ','#','#','#',' ','#','#',' ','#','#'},
    {'#','#',' ','#','#','#',' ','#','#','#',' ',' ',' ','#',' ','#','#',' ','#','#'},
    {'#','#',' ','#',' ',' ',' ','#','#','#',' ','#',' ','#',' ','#','#',' ','#','#'},
    {'#','#',' ','#','#','#',' ','#','#','#',' ','#',' ','#',' ','#','#',' ','#','#'},
    {'#','#',' ','#','#','#',' ','#','#','#',' ','#',' ',' ',' ','#','#',' ','#','#'},
    {'#','#',' ',' ',' ',' ',' ','#','#','#',' ','#','#','#','#','#','#',' ','#','#'},
    {'#','#',' ','#','#','#',' ','#','#','#',' ','#','#','#','#','#','#',' ','#','#'},
    {'#','#',' ','#','#','#',' ',' ',' ',' ',' ','#','#','#','#','#','#',' ','#','#'},
    {'#','#',' ','#','#','#','#',' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '},
    {'#','#',' ','#','#','#',' ',' ','#','#','#','#','#','#','#','#','#','#','#','#'},
    {'#','#',' ',' ',' ',' ',' ','#','#','#','#','#','#','#','#','#','#','#','#','#'},
  };
  printf("Find %d ways to go out\n", Find_way(maze,1,0));
  return 0;
}

int Find_way(char maze[SIZE][SIZE],int x,int y)
{
  static int cnt=0;
  if (y==SIZE-1)
  {
    maze[x][y]='.';
    printf("The %d way:\n",++cnt);
    Print_maze(maze);
    maze[x][y]=' ';
  }
  if (Access(maze,x+1,y)==' ') {maze[x+1][y]='.';Find_way(maze,x+1,y);maze[x+1][y]=' ';}
  if (Access(maze,x-1,y)==' ') {maze[x-1][y]='.';Find_way(maze,x-1,y);maze[x-1][y]=' ';}
  if (Access(maze,x,y+1)==' ') {maze[x][y+1]='.';Find_way(maze,x,y+1);maze[x][y+1]=' ';}
  if (Access(maze,x,y-1)==' ') {maze[x][y-1]='.';Find_way(maze,x,y-1);maze[x][y-1]=' ';}
  return cnt;
}

char Access(char maze[SIZE][SIZE],int x,int y)
{
  if (x<0||y<0||x>=SIZE||y>=SIZE) return '#';
  else return maze[x][y];
}

void Print_maze(char maze[SIZE][SIZE])
{
  int i,j;
  for (i=0;i<SIZE;i++) {
    for (j=0;j<SIZE;j++) {
      printf ("%c ",maze[i][j]);
    }
    printf ("\n");
  }
}
